<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Estimates the optimal complexity parameter for the SDTree using cross-validation. 
The transformations are estimated for each training set and validation set 
separately to ensure independence of the validation set."><title>Cross-validation for the SDTree — cvSDTree • SDForest</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Cross-validation for the SDTree — cvSDTree"><meta property="og:description" content="Estimates the optimal complexity parameter for the SDTree using cross-validation. 
The transformations are estimated for each training set and validation set 
separately to ensure independence of the validation set."><meta property="og:image" content="https://markusul.github.io/SDForest/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">SDForest</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/SDForest.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/SDTree.html">SDTree</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Cross-validation for the SDTree</h1>
      
      <div class="d-none name"><code>cvSDTree.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Estimates the optimal complexity parameter for the SDTree using cross-validation. 
The transformations are estimated for each training set and validation set 
separately to ensure independence of the validation set.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">cvSDTree</span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  x <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  y <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  max_leaves <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cp <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>  min_sample <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  mtry <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  fast <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  Q_type <span class="op">=</span> <span class="st">"trim"</span>,</span>
<span>  trim_quantile <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  q_hat <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  Q <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  A <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  gamma <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  gpu <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  mem_size <span class="op">=</span> <span class="fl">1e+07</span>,</span>
<span>  max_candidates <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  n_cv <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  cp_seq <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  mc.cores <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>formula</dt>
<dd><p>Object of class <code>formula</code> or describing the model to fit 
of the form <code>y ~ x1 + x2 + ...</code> where <code>y</code> is a numeric response and 
<code>x1, x2, ...</code> are vectors of covariates. Interactions are not supported.</p></dd>


<dt>data</dt>
<dd><p>Training data of class <code>data.frame</code> containing the variables in the model.</p></dd>


<dt>x</dt>
<dd><p>Predictor data, alternative to <code>formula</code> and <code>data</code>.</p></dd>


<dt>y</dt>
<dd><p>Response vector, alternative to <code>formula</code> and <code>data</code>.</p></dd>


<dt>max_leaves</dt>
<dd><p>Maximum number of leaves for the grown tree.</p></dd>


<dt>cp</dt>
<dd><p>Complexity parameter, minimum loss decrease to split a node. 
A split is only performed if the loss decrease is larger than <code>cp * initial_loss</code>, 
where <code>initial_loss</code> is the loss of the initial estimate using only a stump.</p></dd>


<dt>min_sample</dt>
<dd><p>Minimum number of observations per leaf. 
A split is only performed if both resulting leaves have at least 
<code>min_sample</code> observations.</p></dd>


<dt>mtry</dt>
<dd><p>Number of randomly selected covariates to consider for a split, 
if <code>NULL</code> all covariates are available for each split.</p></dd>


<dt>fast</dt>
<dd><p>If <code>TRUE</code>, only the optimal splits in the new leaves are 
evaluated and the previously optimal splits and their potential loss-decrease are reused. 
If <code>FALSE</code> all possible splits in all the leaves are reevaluated after every split.</p></dd>


<dt>Q_type</dt>
<dd><p>Type of deconfounding, one of 'trim', 'pca', 'no_deconfounding'. 
'trim' corresponds to the Trim transform (Ćevid et al. 2020)
 
as implemented in the Doubly debiased lasso (Guo et al. 2022)
, 
'pca' to the PCA transformation(Paul et al. 2008)
. 
See <code><a href="get_Q.html">get_Q</a></code>.</p></dd>


<dt>trim_quantile</dt>
<dd><p>Quantile for Trim transform, 
only needed for trim and DDL_trim, see <code><a href="get_Q.html">get_Q</a></code>.</p></dd>


<dt>q_hat</dt>
<dd><p>Assumed confounding dimension, only needed for pca, 
see <code><a href="get_Q.html">get_Q</a></code>.</p></dd>


<dt>Q</dt>
<dd><p>Spectral transformation, if <code>NULL</code> 
it is internally estimated using <code><a href="get_Q.html">get_Q</a></code>.</p></dd>


<dt>A</dt>
<dd><p>Numerical Anchor of class <code>matrix</code>. See <code><a href="get_W.html">get_W</a></code>.</p></dd>


<dt>gamma</dt>
<dd><p>Strength of distributional robustness, \(\gamma \in [0, \infty]\). 
See <code><a href="get_W.html">get_W</a></code>.</p></dd>


<dt>gpu</dt>
<dd><p>If <code>TRUE</code>, the calculations are performed on the GPU. 
If it is properly set up.</p></dd>


<dt>mem_size</dt>
<dd><p>Amount of split candidates that can be evaluated at once.
This is a trade-off between memory and speed can be decreased if either
the memory is not sufficient or the gpu is to small.</p></dd>


<dt>max_candidates</dt>
<dd><p>Maximum number of split points that are 
proposed at each node for each covariate.</p></dd>


<dt>n_cv</dt>
<dd><p>Number of folds for cross-validation. 
It is recommended to not use more than 5 folds if the number of covariates 
is larger than the number of observations. In this case the spectral 
transformation could differ to much if the validation data is 
substantially smaller than the training data.</p></dd>


<dt>cp_seq</dt>
<dd><p>Sequence of complexity parameters cp to compare using cross-validation, 
if <code>NULL</code> a sequence from 0 to 0.6 with stepsize 0.002 is used.</p></dd>


<dt>mc.cores</dt>
<dd><p>Number of cores to use for parallel computation.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A list containing</p>
<dl><dt>cp_min</dt>
<dd><p>The optimal complexity parameter.</p></dd>

<dt>cp_table</dt>
<dd><p>A table containing the complexity parameter, 
the mean and the standard deviation of the loss on the validation sets for the 
complexity parameters. If multiple complexity parameters result in the same loss, 
only the one with the largest complexity parameter is shown.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Ćevid D, Bühlmann P, Meinshausen N (2020).
“Spectral Deconfounding via Perturbed Sparse Linear Models.”
<em>J. Mach. Learn. Res.</em>, <b>21</b>(1).
ISSN 1532-4435.<br><br> Guo Z, Ćevid D, Bühlmann P (2022).
“Doubly debiased lasso: High-dimensional inference under hidden confounding.”
<em>The Annals of Statistics</em>, <b>50</b>(3).
ISSN 0090-5364, <a href="https://doi.org/10.1214/21-AOS2152" class="external-link">doi:10.1214/21-AOS2152</a>
.<br><br> Paul D, Bair E, Hastie T, Tibshirani R (2008).
““Preconditioning” for feature selection and regression in high-dimensional problems.”
<em>The Annals of Statistics</em>, <b>36</b>(4).
ISSN 0090-5364, <a href="https://doi.org/10.1214/009053607000000578" class="external-link">doi:10.1214/009053607000000578</a>
.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="SDTree.html">SDTree</a></code> <code><a href="prune.SDTree.html">prune.SDTree</a></code> <code><a href="regPath.SDTree.html">regPath.SDTree</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Markus Ulmer</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">50</span></span></span>
<span class="r-in"><span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span> <span class="op">*</span> <span class="fl">5</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="va">n</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sign.html" class="external-link">sign</a></span><span class="op">(</span><span class="va">X</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">*</span> <span class="fl">3</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">0</span>, <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cp</span> <span class="op">&lt;-</span> <span class="fu">cvSDTree</span><span class="op">(</span>x <span class="op">=</span> <span class="va">X</span>, y <span class="op">=</span> <span class="va">y</span>, Q_type <span class="op">=</span> <span class="st">'no_deconfounding'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cp</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $cp_min</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    cp </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.076 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $cp_table</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          cp SDLoss mean SDLoss sd</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,] 0.044    30.89977  4.336556</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,] 0.056    30.65170  5.398475</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,] 0.058    30.60373  5.370633</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,] 0.070    31.28713  5.866639</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,] 0.076    29.12192  5.155334</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,] 0.106    31.64469  3.284572</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] 0.132    32.25506  3.564472</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] 0.262    30.93818  5.837083</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] 0.326    31.50641  6.333261</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] 0.362    33.27446  3.286796</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,] 0.600    34.64608  4.718930</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Markus Ulmer.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer></div>

  

  

  </body></html>

